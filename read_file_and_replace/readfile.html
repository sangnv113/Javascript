<!DOCTYPE html>
<html>
<title>...</title>

<head>
</head>
<style>
    .option {
        padding: 14px 16px;
        border: 3px solid #297e07;
    }
 </style>
<body>
    <div class='option'>
        <div>
            <div id="rdTypeInput">
                <input type="radio" id="rdFile" name="typeInput" value="file"> File
                <input type="radio" id="rdText" name="typeInput" value="text" checked="checked"> Text
                <br>
                <!-- <input type="text" id="splitInput"> -->
                <br>
                <input type="text" id="splitRegex">
                <br>
                <input type="text" id="splitChildRegex">
            </div>
        </div>
    </div>
    <div>
            <input type="file" accept="text/plain" name="inputfile" id="inputfile">
            <br>
            <textarea style='width: 400px; height: 400px;;' id='txtIntput'></textarea>
            <br>
        <textarea style='width: 100px; height: 200px;' id='regex'></textarea>
        <br>
        <input type='submit' id='execute'>
        <p>result:</p>
        <textarea style='width: 400px; height: 400px;' id='output'></textarea>

    </div>
    <script>
        document.getElementById('regex').textContent = 'a^g';
        // document.getElementById('splitInput').value  = '\n';
        document.getElementById('splitRegex').value  = '`';
        document.getElementById('splitChildRegex').value  = '^';
        
        // var split = document.getElementById('splitInput').value;
        var trSplitLine = document.getElementById('splitRegex').value;
        var trSplitElement = document.getElementById('splitChildRegex').value;
        var split ='\n';
        // var trSplitLine ='`';
        // var trSplitElement ='^';

        var rdFile = document.getElementById('rdFile');
        var rdText = document.getElementById('rdText');
        var inputfile = document.getElementById('inputfile');
        var txtIntput = document.getElementById('txtIntput');
        
        inputfile.style.display = "none";

        var executeBtn = document.getElementById('execute');
        
            var ele = document.getElementsByName('typeInput');
            
            executeBtn.addEventListener('click', () => {
                    var txtArr = [];
                    var typeInput = '';
                    var regex = document.getElementById('regex').value;

                    for (i = 0; i < ele.length; i++) {
                        if (ele[i].checked)
                            typeInput = ele[i].value;
                    }
                    if (typeInput == 'file') {
                        var file = document.getElementById('inputfile');
                        var fr = new FileReader();
                        fr.onload = function () {
                            var lineInputs = this.result.split(split);
                            txtArr = processingReplace(lineInputs, regex, txtArr);
                        }
                        fr.onloadend = function () {
                            console.log(txtArr);
                            document.getElementById('output').textContent = txtArr.join('\n');
                        }

                        fr.readAsText(file.files[0]);
                    } else {
                        var txtIntput = document.getElementById('txtIntput').value;

                        var lineInputs = txtIntput.split(split);
                        txtArr = processingReplace(lineInputs, regex, txtArr);
                        document.getElementById('output').textContent = txtArr.join('\n');

                    }
                })

        function processingReplace(lineInputs, regex, txtArr) {
                for (var i = 0; i < lineInputs.length; i++) {
                    if (regex != '') {

                        var trLines = regex.split(trSplitLine);
                        var trResult = lineInputs[i];
                        for (var trLine = 0; trLine < trLines.length; trLine++) {
                            var trElements = trLines[trLine].split(trSplitElement);
                            trResult = trResult.replaceAll(trElements[0], trElements[1]);
                        }
                        txtArr.push(trResult);
                    }
                }
                return txtArr;
            }
      
        rdText.addEventListener('click', () => {
            inputfile.style.display = "none";
            txtIntput.style.display = "block";

        });
        rdFile.addEventListener('click', () => {
            inputfile.style.display = "block";
            txtIntput.style.display = "none";

        })
    </script>
</body>

</html>